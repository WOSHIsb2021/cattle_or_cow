# 近交系数

## 基本概念

遗传学中关于亲缘关系的常见的几个系数辨析：

**血缘系数 coefficient** **of kinship** / kinship coefficient，有些地方称为**近亲系数**，有时也称**共祖系数 coefficient of coancestry**， （目前缺少权威的中文翻译），是对个体间血缘关系的直接衡量，定义为从**两个个体**随机抽取一个同源等位基因，所抽取的两个等位基因是血缘同源（IBD）的概率（即这两个等位基因相同，且来自同一个祖先）。

常用的用来衡量亲缘关系的，且容易混淆的系数还有如下两个，近交系数与血缘系数。

**近交系数** ***\*coefficient\**** **of inbreeding** ，由怀特（ Wright, Sewall ）最早定义，是指 **一个个体**的某个基因座上的**两个等位基因为血缘同源 （IBD） 的概率**，衡量的是这个个体父母间亲缘程度的大小，反映的是近亲交配的程度。有时也称为固定系数 fixation index ，通常用 **F** 表示。

***\*亲缘系数\** coefficient of relationship** / **coefficient of relatedness** ，该系数也由怀特定义，衍生自他对**近交系数**的定义**，** 是指**有共同祖先的两个个体间，基因型一致的概率**，通常用 **r** 来表示。数值上是 ***\*血缘系数\**** 的两倍。

对于常见亲缘关系这三个系数的理论值如下图所示：

| 与个体的**关系**             | ***\*血缘系数\**** | **近交系数** F | ***\*亲缘系数\**** r |
| ---------------------------- | ------------------ | -------------- | -------------------- |
| 自己，同卵双胞胎             | 1/2                | 1/2            | 1                    |
| 亲兄弟姐妹                   | 1/4                | 1/4            | 1/2                  |
| 母父，儿女*                  | 1/4                | 1/4            | 1/2                  |
| 祖父母，孙子孙女             | 1/8                | 1/8            | 1/4                  |
| 舅舅，舅妈，侄女，侄子       | 1/8                | 1/8            | 1/4                  |
| 表兄弟                       | 1/16               | 1/16           | 1/8                  |
| 同父异母或同母异父的兄弟姐妹 | 1/8                | 1/8            | 1/4                  |

***注意**，虽然近交系数与血缘系数值相等，当他们的概念并不相同。

血缘系数是指两个个体间的血缘关系，如 （ 母父，儿女 ）这一项，血缘系数为1/4的意思是从一个个体与其亲生父母或孩子个随机抽取一个同源等位基因，这两个等位基因相同，且来自同一个祖先 的概率是1/4.

而**近交系数**在这里的值为虽然也为1/4，但其表达的意思是如果这个**个体与其 亲生父母或孩子近交**后，子代的某个基因座上的两个等位基因为血缘同源的概率 为1/4.

原文见：[GWASLab](https://gwaslab.org/2021/05/22/coefficient-of-kinship-inbreeding-relationship/)

## 思路与方法

使用**递归方法结合备忘录（Memoization）**来计算，比较直观且效率较高，避免了重复计算。核心思想是：

1. 个体 X 的近交系数 F_X 等于其父母 S 和 D 之间的亲缘系数（记作 r_SD）的一半，即 F_X = 0.5 * r_SD。
2. 两个个体 A 和 B 之间的亲缘系数 r_AB 可以递归地计算。假设 B 的父母是 S_B 和 D_B，则 r_AB = 0.5 * (r_{A, S_B} + r_{A, D_B})。
3. 特殊情况：任何个体 A 与自身的亲缘系数 r_AA = 1 + F_A。例如，对于一个非近交个体 (F_A = 0)，r_AA = 1 + 0 = 1。
4. 基础情况：如果一个个体（或其父母）在系谱中未知（通常用 0 或 null 表示），相关的亲缘系数 (r) 或近交系数 (F) 为 0。
